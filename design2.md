# プログラミング編
JavaScriptを使って、ブラウザに命令し、絵を描く方法がわかったところで、実際にゲームを作っていきましょう。

## どんなプログラムが必要かを考える
まずはじめに、必要な機能を考え、設計をしましょう。
ハノイの塔をつくるにあたって必要な機能はざっとこの通りになります。

1. 土台の楕円を描画する
2. 円盤を管理する
3. 円盤を表示する
4. 円盤をマウスで移動する
5. クリア条件を満たしているかどうかを判定する

このリストを見て

* どのような変数を用意すればゲームの状態を保存できるか
* どのようなプログラムを書けば円盤を描画できるか

を考えてみてください。

実感が湧きましたか？
この工程は慣れの部分もありますが、何にしても最初によく練ってから作り始めることは、後々設計ミスでやり直しになることを防ぐことができるので、できるだけよく設計を練るようにしましょう（筆者自身への戒め）。

## 描画関数をつくる
プログラムが実行する流れを考えると、描画処理はゲームの状態が変わるごとにしなければなりません。
またゲーム終了時には、最初の状態に戻さなければなりません。
これらの処理は何度も行うので、毎回同じコードを書いていたら大変です。というわけでまとめるための枠を作りましょう。

前の章で関数というものを使いましたが、これは自分で作ることができます。つまり命令を自分で用意しておいて、必要なタイミングで呼ぶことができるようにするのです。

`<script>`の中身を次のようにしましょう。

```javascript
var canvas = document.getElementById("screen");
var width = canvas.width;
var height = canvas.height;
var ctx = canvas.getContext("2d");

function draw() {
    ctx.clearRect(0, 0, width, height);
}

function init() {
    draw();
}

init();
```

`function 関数名(引数)` で関数を定義することができます。それに続く`{`から`}`までが関数の中身になります。

`draw`は描画を行う関数です。とりあえず、現在`<canvas>`に描かれている内容をクリアする`ctx.clearRect`（引数の指定方法は`rect`と同じ）を呼び出すコードだけ書きました。

`init`はゲームの状態を初期状態にする関数です。まだ状態を保存する変数を用意していないので、最初の`draw`の呼び出しを行うだけです。

最後に`init();`で実際に`init`関数を呼び出しています。

これで描画処理を書く準備ができました。次のページに進みましょう。
